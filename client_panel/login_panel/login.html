<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    </head>
    <body>
        <div class="loginPanel">
            <div style="margin-right: auto; margin-left: auto; width: 250px; height: 150px; margin-top: 45px">

                <label for="username">Login: </label>
                <input type="text" id="username" name="fname"><br><br>
                <label for="password">Has≈Ço: </label>
                <input type="password" id="password" name="lname"><br><br>
                <button id="submitButton">Logowanie</button>
                <button id="registerButton">Rejestracja</button>
<!--            <form action="/register" method="get" style="float: left; margin-top: -21px; margin-left: 160px">-->
<!--                <input type="submit" value="Register">-->
<!--            </form>-->

            </div>
        </div>
        </body>

<script>

    // let login = (async function checkLogin(){
    //     if(localStorage.getItem("token")){
    //         $.ajax({
    //             url: "https://localhost:8443/auth",
    //             type: 'POST',
    //             data: {
    //                 token: localStorage.getItem("token")
    //             },
    //             "Content-Type": 'application/json',
    //             success: function (msg, textStatus, request) {
    //                 window.open("/details", "_self")
    //             },
    //             error: function(err,text,request) {
    //                 window.open("/login", "_self")
    //             }
    //         })
    //     }
    // })();

    $('#submitButton').on('click',function() {
        $.ajax({
            url: "https://localhost:8443/login",
            type: 'POST',
            data: {
                firstName: $('#username').val(),
                lastName: $('#password').val()
            },
            "Content-Type": 'application/json',
            success: function (msg, textStatus, request) {
                localStorage.setItem("token", msg.token)
                console.log(window.body, "<<<<<<<<<<< WINDOW BOD?Y")

                const myHeaders = new Headers();
                myHeaders.set("Authorization", "Berarer " + msg.token)
                // myHeaders.set("Content-Type", "text/html");
                window.open("/details", "_self", myHeaders)
            }
        })
    });

</script>
</html>